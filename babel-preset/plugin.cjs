"use strict";var e=require("@babel/helper-plugin-utils"),t=require("@babel/plugin-syntax-jsx"),n=require("@babel/core"),s=require("@babel/helper-module-imports"),r=require("validate-html-nesting");const i=(()=>{const e={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},t=/[&<>'"]/g,n=t=>e[t];return function(e){return e.replace(t,n)}})(),a=(()=>{const e={"'":"&#39;",'"':"&quot;"},t=/['"]/g,n=t=>e[t];return function(e){return e.replace(t,n)}})();const o=(e,t)=>e.get(`@babel/plugin-pota-jsx/${t}`),p=(e,t,n)=>e.set(`@babel/plugin-pota-jsx/${t}`,n);function u(e,t,s){return n.types.callExpression(o(e,`id/${t}`)(),s)}function l(e){const t=e.get("openingElement"),s=c(t.node.name,t.node);let r;return n.types.isIdentifier(s)?r=s.name:n.types.isStringLiteral(s)&&(r=s.value),n.types.react.isCompatTag(r)?n.types.stringLiteral(r):s}function c(e,t){return n.types.isJSXIdentifier(e)?"this"===e.name&&n.types.isReferenced(e,t)?n.types.thisExpression():n.types.isValidIdentifier(e.name,!1)?(e.type="Identifier",e):n.types.stringLiteral(e.name):n.types.isJSXMemberExpression(e)?n.types.memberExpression(c(e.object,e),c(e.property,e)):n.types.isJSXNamespacedName(e)?n.types.stringLiteral(`${e.namespace.name}:${e.name.name}`):e}function m(e){return n.types.isStringLiteral(e)||n.types.isNumericLiteral(e)||n.types.isStringLiteral(e.value?.expression)||n.types.isNumericLiteral(e.value?.expression)}function d(e){return n.types.isStringLiteral(e.value?.expression)||n.types.isNumericLiteral(e.value?.expression)?i(e.value?.expression.value):i(e.value)}function g(e,t,n){""!==n.trim()?/"|'|=|<|>|`|\s/.test(n)?e.content+=" "+t+"='"+a(n)+"'":e.content+=" "+t+"="+a(n):e.content+=" "+t}function f(e){return n.types.isStringLiteral(e.value.expression)||n.types.isNumericLiteral(e.value.expression)?String(e.value.expression.value):String(e.value.value)}function y(e,t){return n.types.jSXAttribute(n.types.jSXIdentifier(e),n.types.stringLiteral(t))}function h(e,t){const s=e.reduce(b,[]);if(t&&t.length>0&&s.push(x(t)),s.length)return n.types.objectExpression(s)}function x(e){let t;if(1===e.length)t=e[0];else{if(!(e.length>1))return;t=n.types.arrayExpression(e)}return n.types.objectProperty(n.types.identifier("children"),t)}function b(e,t){if(t="node"in t?t.node:t,n.types.isJSXSpreadAttribute(t)){const s=t.argument;return n.types.isObjectExpression(s)&&!s.properties.some((e=>n.types.isObjectProperty(e,{computed:!1,shorthand:!1})&&(n.types.isIdentifier(e.key,{name:"__proto__"})||n.types.isStringLiteral(e.key,{value:"__proto__"}))))?e.push(...s.properties):e.push(n.types.spreadElement(s)),e}const s=function(e){return n.types.isJSXExpressionContainer(e)?e.expression:e}(t.value||n.types.booleanLiteral(!0));var r;n.types.isStringLiteral(s)&&!n.types.isJSXExpressionContainer(t.value)&&(s.value=s.value.replace(/\n\s+/g," "),null==(r=s.extra)||delete r.raw);return n.types.isJSXNamespacedName(t.name)?t.name=n.types.stringLiteral(t.name.namespace.name+":"+t.name.name.name):n.types.isValidIdentifier(t.name.name,!1)?t.name.type="Identifier":t.name=n.types.stringLiteral(t.name.name),e.push(n.types.inherits(n.types.objectProperty(t.name,s),t)),e}const v=new Set(["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]);function S(e){return v.has(e.toLowerCase())}function L(e,t,n){if(!r.isValidHTMLNesting(e,t))throw n._path.buildCodeFrameError(`Invalid HTML: <${e}> cannot be child of <${t}>`)}function E(e){const t=e.get("openingElement"),s=c(t.node.name,t.node);let r;return n.types.isIdentifier(s)?r=s.name:n.types.isStringLiteral(s)&&(r=s.value),!!n.types.react.isCompatTag(r)&&r}function j(e,t){let s=!1;const r=function(e){return E(e)}(e),i={tagName:r,content:`<${r} pota`,props:[]},a=[];for(const t of e.get("openingElement").get("attributes")){if(t.isJSXAttribute()&&n.types.isJSXIdentifier(t.node.name)){const e=t.node.name.name;if("xmlns"===e&&(s=!0),"xmlns"!==e&&(o=t.node,n.types.isStringLiteral(o.value)||n.types.isNumericLiteral(o.value)||n.types.isStringLiteral(o.value?.expression)||n.types.isNumericLiteral(o.value?.expression))){g(i,e,f(t.node));continue}}a.push(t)}var o;if(!s)switch(r){case"svg":a.push(y("xmlns","http://www.w3.org/2000/svg")),s=!0;break;case"math":a.push(y("xmlns","http://www.w3.org/1998/Math/MathML")),s=!0;break;case"foreignObject":a.push(y("xmlns","http://www.w3.org/1999/xhtml")),s=!0}S(r)?i.content+=" />":i.content+=">";let p=n.types.react.buildChildren(e.node);!function(e,t){for(const n of t)w(n)&&L(e,n.tagName,n)}(i.tagName,p),p=function(e,t){const n=[];for(let s=0;s<e.length;s++){const r=e[s];if(m(r))t.content+=d(r),n.push(r);else{if(!w(r))break;t.content+=N(r),r.arguments[1].elements.length&&t.props.push(...r.arguments[1].elements),n.push(r)}}return e.filter((e=>!n.includes(e)))}(p,i),p=X(p);const l=h(a,p);l?i.props.unshift(l):i.content=i.content.replace(/^<([^\s]+) pota/,"<$1"),S(r)||(i.content+=`</${r}>`);const c=u(t,"template",[n.types.stringLiteral(i.content),n.types.arrayExpression(i.props)]);return c.isXML=s,c.isTemplate=!0,c.tagName=r,c._path=e,c}function w(e){return e.isTemplate&&!e.isXML}function N(e){return e.arguments[0].value}function X(e){const t=[];let n=0,s=e[n],r=e[++n];for(;s&&r;){if(m(s)){if(m(r)){s.value+=d(r),t.push(r),r=e[++n];continue}if(w(r)){r.arguments[0].value=d(s)+N(r),t.push(s),s=r,r=e[++n];continue}}if(w(s)){if(m(r)){s.arguments[0].value+=d(r),t.push(r),r=e[++n];continue}if(w(r)){s.arguments[0].value+=N(r),r.arguments[1].elements.length&&s.arguments[1].elements.push(...r.arguments[1].elements),t.push(r),r=e[++n];continue}}s=r,r=e[++n]}return e.filter((e=>!t.includes(e)))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function({name:r}){return e.declare((e=>({name:r,inherits:t.default,visitor:{JSXNamespacedName(e){},JSXSpreadChild(e){throw e.buildCodeFrameError("Spread children are not supported.")},Program:{enter(e,t){const r=(r,i)=>p(t,r,function(e,t,r){return()=>{const i="pota/jsx-runtime";let a=o(e,`imports/${r}`);return a?n.types.cloneNode(a):(a=s.addNamed(t,r,i,{importedInterop:"uncompiled",importPosition:"after"}),p(e,`imports/${r}`,a),a)}}(t,e,i));r("id/jsx","jsx"),r("id/fragment","Fragment"),r("id/template","template")},exit(e){e.traverse({CallExpression(e){w(e.node)&&0===e.node.arguments[1].elements.length&&function(e,t){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}(e.node.arguments,e.node.arguments[1])}})}},JSXFragment:{exit(e,t){const s=function(e,t){const s=[o(t,"id/fragment")()],r=X(n.types.react.buildChildren(e.node));return s.push(n.types.objectExpression(r.length>0?[x(r)]:[])),u(t,"jsx",s)}(e,t);e.replaceWith(n.types.inherits(s,e.node))}},JSXElement:{exit(e,t){const s=E(e)?j(e,t):function(e,t){const s=[l(e)],r=h(e.get("openingElement").get("attributes"),X(n.types.react.buildChildren(e.node)));return r&&s.push(r),u(t,"jsx",s)}(e,t);e.replaceWith(n.types.inherits(s,e.node))}},JSXAttribute(e){n.types.isJSXElement(e.node.value)&&(e.node.value=n.types.jsxExpressionContainer(e.node.value))}}})))}({name:"transform-pota-jsx"});
